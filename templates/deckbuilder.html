{% extends "_base.html" %}
{% block content %}
<script type="text/javascript" src="/static/js/list.pagination.min.js"></script>
<div id="decklist">
	<form id="decklist_saver_form" action="/mydecklists">
		<div id="goldborder-top"></div>
		<div id="chartborder">
			<svg class="chart" data-bar-chart data-data="" data-bar-width="8"></svg>
		</div>
		<p id="curvelist"><img src="/static/assets/mana-curve.png"></p>
		<div id="deckname_container">
			<input id="deck_name_box" type="text" name="deckname" Placeholder="Enter Deck Name Here...">
		</div>
		<p id="cardcounter">0 / 30</p>
		<div id="goldborder-bottom"></div>

		<div id="scrollhandler">
		<ul id='inner_list'>
			<li></li>
		</ul>
		</div>

		<div id="goldborder-top-below"></div>
		<p id="dustcounter">0 Dust to Craft</p>
		<p id="clearexport">
			<button type="button" onclick="resetDeck()">Reset</button>
			<button type="button" onclick="exportDeck(500, 500)" data-toggle="modal" data-target="#exportPopup">Export</button>
			<!-- <button type="button" onclick="PrepareDeck()">Save</button> -->
			<button type="button" data-toggle="modal" data-target="#writeupPopup">Save</button>
		</p>
		<div id="goldborder-bottom-below"></div>
	</form>
</div>

<div id="deckbuilder" class="container">
	<div height="0px" style="height: 0px;">
		<a id="seekclasscards" href="#" title="Class Cards">
			<img height="40px" src="/static/assets/{{playerClass}}-icon.png">
		</a>
		<a id="seekneutralcards" href="#" title="Neutral Cards">
			<img height="40px" src="/static/assets/neutral-icon.png">
		</a>
		<a id="helppop" href="#" title="Neutral Cards" data-toggle="modal" data-target="#helpPopup">
			<img height="35px" src="/static/assets/help.png">
		</a>
	</div>
	<div class="card-page-navigation">
		<a id="btn-prev" href="#" title="Previous"><img src="/static/assets/left_arrow.png"></a>
		<a id="btn-next" href="#" title="Next"><img src="/static/assets/right_arrow.png"></a>
	</div>
	<input class="search" Placeholder="Search by card name, mana cost, type, rarity, etc..."/>
	<div id="object" class="list slideLeft">
		{% for ccard in class_cards %}
		<a cardName="{{ccard.name}}" 
			href="#" 
			onclick="addCard(this); return false;" 
			imgurl="{{ccard.img}}"
			cardId="{{ccard.cardId}}"
			cardSet="{{ccard.cardSet}}"
			type="{{ccard.type}}"
			rarity="{{ccard.rarity}}"
			cost="{{ccard.cost}}"
			attack="{{ccard.attack}}"
			health="{{ccard.health}}"
			cardtext="{{ccard.text}}"
			artist="{{ccard.artist}}"
			title="{{ccard.name}}" 
		>
			<img class="builder_card" width="20%" src="{{ccard.img}}">
			<p hidden class="name">{{ccard.name}}</p>
			<p hidden class="type">{{ccard.type}}</p>
			<p hidden class="cost">{{ccard.cost}}</p>
			<p hidden class="rarity">{{ccard.rarity}}</p>
			<p hidden class="race">{{ccard.race}}</p>
			<p hidden class="artist">{{ccard.artist}}</p>
			<p hidden class="cardset">{{ccard.cardSet}}</p>
			<p hidden class="mechanics">{{ccard.mechanics}}</p>
		</a>
		{% endfor %}

		<a class="placeholder">
			<img class="builder_card" width="20%" src="/static/assets/blank_card.png">
		</a>
		<a class="placeholder">
			<img class="builder_card" width="20%" src="/static/assets/blank_card.png">
		</a>
		{% if playerClass != "Hunter" %}
		<a class="placeholder">
			<img class="builder_card" width="20%" src="/static/assets/blank_card.png">
		</a>
		{% endif %}
	
		{% for ncard in neutral_cards %}
		<a cardName="{{ncard.name}}" 
			href="#" 
			onclick="addCard(this); return false;" 
			imgurl="{{ncard.img}}"
			cardId="{{ncard.cardId}}"
			cardSet="{{ncard.cardSet}}"
			type="{{ncard.type}}"
			rarity="{{ncard.rarity}}"
			cost="{{ncard.cost}}"
			attack="{{ncard.attack}}"
			health="{{ncard.health}}"
			cardtext="{{ncard.text}}"
			artist="{{ncard.artist}}"
			title="{{ncard.name}}" 
		>
			<img class="builder_card" width="20%" src="{{ncard.img}}">
			<p hidden class="name">{{ncard.name}}</p>
			<p hidden class="type">{{ncard.type}}</p>
			<p hidden class="cost">{{ncard.cost}}</p>
			<p hidden class="rarity">{{ncard.rarity}}</p>
			<p hidden class="race">{{ncard.race}}</p>
			<p hidden class="artist">{{ncard.artist}}</p>
			<p hidden class="cardset">{{ncard.cardset}}</p>
			<p hidden class="mechanics">{{ncard.mechanics}}</p>
		</a>
		{% endfor %}
	</div>
	<div hidden class="pagination"></div>
	
</div>

<!-- Modal -->
  <div class="modal fade" id="exportPopup" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Decklist Export</h4>
        </div>
        <div class="modal-body" id="deckbody">
        </div>
        <div class="modal-footer">
        	<button type= "button" class="btn btn-default" id="copy-button" data-clipboard-target="deck_export_area">Copy to Clipboard</button>
          	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<!-- Modal -->
  <div class="modal modal-wide fade" id="writeupPopup" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Decklist Description</h4>
        </div>
        <!-- <div class="modal-body" id="writeupbody" contenteditable="true">
        </div> -->
        <div id="txtEditor"></div>
		<script type="text/javascript">
			$(document).ready( function() {
				var editor = $("#txtEditor").Editor({'togglescreen':false});          
			});
		</script>
        <div class="modal-footer">
		  <button type="button" class="btn btn-default" id="writeupsave" onclick="PrepareDeck()">Save</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>

<!-- Modal -->
  <div class="modal fade" id="helpPopup" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">HSDeckAssistant Builder Help</h4>
        </div>
        <div class="modal-body" id="helpbody">

        	<div style="text-align: left;">
	       		<p>Deck Builder Features:</p>
	       		<br>
	       		<ul class="helplist">
	       			<li>-  Navigation via keyboard (left/right), clickable arrows, or search.</li>
	       			<li>-  Search by mana cost, tribe, name, artist, and card mechanics (Battlecry, Taunt, etc...).</li>
	       			<li>-  Simply click on cards to add them to your deck!</li>
	       			<li>-  Use mousewheel on decklist to view cards in "oversized" decklists</li>
	       			<li>-  Jump to class and neutral cards with their respective buttons in the top right</li>
	       			<li>-  Export your deck to Cockatrice format (compatible with hsDeckTracker and other tools)</li>
	       			<li>-  Completely reset your deck with the "Reset" button</li>
	       			<li>-  When you're done building, click the "Save" button to begin your deck's explanation in our Rich Text Editor. If you decide to change a card and close the editor, your progress persists unless you navigate away from this page.</li>
	       		</ul>

	       	</div>

        </div>
        <div class="modal-footer">
          	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<script type="text/javascript">

	// when .modal-wide opened, set content-body height based on browser height; 200 is appx height of modal padding, modal title and button bar

	$(".modal-wide").on("show.bs.modal", function() {
	  var height = $(window).height() - 200;
	  $(this).find(".modal-body").css("max-height", height);
	});

	//next and previous buttons
	$('#btn-next').on('click', function(){
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[position+1]).trigger('click');
	        }
	    })

	})
	$('#btn-prev').on('click', function(){
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[position-1]).trigger('click');
	        }
	    })
	})

	//next and previous keys
	$("body").keydown(function(e) {
	  if(e.keyCode == 37) { // left
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[position-1]).trigger('click');
	        }
	    })
	  }
	  else if(e.keyCode == 39) { // right
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[position+1]).trigger('click');
	        }
	    })
	  }
	});

	//class and neutral card buttons
	$('#seekclasscards').on('click', function(){
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[0]).trigger('click');
	        }
	    })

	})
	$('#seekneutralcards').on('click', function(){
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[6]).trigger('click');
	        }
	    })
	})

		
</script>
<script type="text/javascript" src="/static/js/deckbuilder.js"></script>


{% endblock %}